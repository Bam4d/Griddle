

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OpenAI Gym Interface &mdash; Griddly 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Raw interface (experimental)" href="../raw/index.html" />
    <link rel="prev" title="Installation" href="../installation/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Griddly
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">OpenAI Gym Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#obvserver-types">Obvserver Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gd-observertype-sprite-2d">gd.ObserverType.SPRITE_2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gd-observertype-block-2d">gd.ObserverType.BLOCK_2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gd-observertype-vector">gd.ObserverType.VECTOR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-global-observer">The Global Observer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../raw/index.html">Raw interface (experimental)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gdy/index.html">Griddly Description YAML</a></li>
</ul>
<p class="caption"><span class="caption-text">Games</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../games/index.html">Games</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/GDY/index.html">GDY Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/GDY Schema/index.html">GDY Schema Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/GDY/index.html">Griddy Description YAML</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Griddly</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>OpenAI Gym Interface</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/getting-started/gym/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="openai-gym-interface">
<span id="doc-getting-started-gym"></span><h1>OpenAI Gym Interface<a class="headerlink" href="#openai-gym-interface" title="Permalink to this headline">¶</a></h1>
<p>Games defined with <a class="reference internal" href="../gdy/index.html#doc-getting-started-gdy"><span class="std std-ref">GDY</span></a> files can easily be wrapped by OpenAI’s gym interface.</p>
<p>Games are currently not automatically imported into the OpenAI wrapper wehn the python libraries are loaded.
The reason for this is that Griddly environments are highly flexible and the gym wrapper is not.</p>
<p>To use the OpenAI Gym wrapper there you must first define the game and observers you wish to use.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">from</span> <span class="nn">griddly_python</span> <span class="kn">import</span> <span class="n">GymWrapperFactory</span><span class="p">,</span> <span class="n">gd</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">wrapper</span> <span class="o">=</span> <span class="n">GymWrapperFactory</span><span class="p">()</span>

    <span class="n">environment_name</span> <span class="o">=</span> <span class="s1">&#39;sokoban&#39;</span>
    <span class="n">level</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="n">wrapper</span><span class="o">.</span><span class="n">build_gym_from_yaml</span><span class="p">(</span><span class="n">environment_name</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;single-player/</span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="s1">.yaml&#39;</span><span class="p">,</span> <span class="n">player_observer_type</span><span class="o">=</span><span class="n">gd</span><span class="o">.</span><span class="n">ObserverType</span><span class="o">.</span><span class="n">SPRITE_2D</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>

    <span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;GDY-</span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="s1">-v0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
<p>Lets break this down a bit:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrapper</span> <span class="o">=</span> <span class="n">GymWrapperFactory</span><span class="p">()</span>
</pre></div>
</div>
<p>The wrapper factory is a utility provided by griddly that wraps the native Griddly environment in an OpenAI gym interface. This is always required to create gym environments.</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">environment_name</span> <span class="o">=</span> <span class="s1">&#39;sokoban&#39;</span>
<span class="n">level</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>We first define some variables.. the filename of the environment we want to load and the particular level in that environment.
In this case we are going to load the game sokoban and the second level that is defined for sokoban</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrapper</span><span class="o">.</span><span class="n">build_gym_from_yaml</span><span class="p">(</span><span class="n">environment_name</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;single-player/</span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="s1">.yaml&#39;</span><span class="p">,</span> <span class="n">player_observer_type</span><span class="o">=</span><span class="n">gd</span><span class="o">.</span><span class="n">ObserverType</span><span class="o">.</span><span class="n">SPRITE_2D</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>
</pre></div>
</div>
<p>This command builds and loads the gym environment with the information supplied. This particular command will load the mechanics of the sokoban environment and the second level defined in the GDY file.
States will be generated by the SPRITE_2D observer.</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;GDY-</span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="s1">-v0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is the familiar gym make command that create the env reference. This can now be used as you would use any other gym environment.</p>
<div class="section" id="obvserver-types">
<h2>Obvserver Types<a class="headerlink" href="#obvserver-types" title="Permalink to this headline">¶</a></h2>
<p>There are three supported observation modes in Griddly:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>for SPRITE_2D and BLOCK_2D observers, each object must define how it should be rendered with an <a class="reference internal" href="../../reference/GDY/Objects/items/Observers/index.html#properties-objects-items-properties-observers"><span class="std std-ref">Observer Configuration</span></a></p>
</div>
<div class="section" id="gd-observertype-sprite-2d">
<h3>gd.ObserverType.SPRITE_2D<a class="headerlink" href="#gd-observertype-sprite-2d" title="Permalink to this headline">¶</a></h3>
<p>Renders sprites defined by the GDY object <cite>Sprite2D</cite> descriptions.</p>
<img alt="../../_images/sprite2D.png" src="../../_images/sprite2D.png" />
</div>
<div class="section" id="gd-observertype-block-2d">
<h3>gd.ObserverType.BLOCK_2D<a class="headerlink" href="#gd-observertype-block-2d" title="Permalink to this headline">¶</a></h3>
<p>Renders sprites defined by the GDY object <cite>Block2D</cite> descriptions.</p>
<p>If the <cite>player_observer_type</cite> argument is set to <cite>player_observer_type=gd.ObserverType.BLOCK_2D</cite> you should see this:</p>
<img alt="../../_images/block2D.png" src="../../_images/block2D.png" />
</div>
<div class="section" id="gd-observertype-vector">
<h3>gd.ObserverType.VECTOR<a class="headerlink" href="#gd-observertype-vector" title="Permalink to this headline">¶</a></h3>
<p>The vector observer is the fastest observer type in Griddly. It can reach tens of thousands of states per second.</p>
<p>Vector observers will return a tensor of shape [<em>objects</em>, <em>width</em>, <em>height</em>] where each value is either 0 or 1 denoting that there is an object of that type in a particular location.</p>
</div>
</div>
<div class="section" id="the-global-observer">
<h2>The Global Observer<a class="headerlink" href="#the-global-observer" title="Permalink to this headline">¶</a></h2>
<p>The global observer can be used alongside any of the other observers and will always render the entire environment regardless of how other observers are defined.
This means that you can pass vector observers to your agents and then render with sprites or blocks to make awesome demos!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrapper</span><span class="o">.</span><span class="n">build_gym_from_yaml</span><span class="p">(</span><span class="n">environment_name</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;single-player/</span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="s1">.yaml&#39;</span><span class="p">,</span> <span class="n">global_observer_type</span><span class="o">=</span><span class="n">gd</span><span class="o">.</span><span class="n">ObserverType</span><span class="o">.</span><span class="n">SPRITE_2D</span><span class="p">,</span> <span class="n">player_observer_type</span><span class="o">=</span><span class="n">gd</span><span class="o">.</span><span class="n">ObserverType</span><span class="o">.</span><span class="n">VECTOR</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;GDY-</span><span class="si">{</span><span class="n">environment_name</span><span class="si">}</span><span class="s1">-v0&#39;</span><span class="p">)</span>

<span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;global&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../raw/index.html" class="btn btn-neutral float-right" title="Raw interface (experimental)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../installation/index.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Chris Bamford

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>